/*!
 * C4Design Library v2.0
 * 
 * Author: dakun.ni@cn.pwc.com 
 *
 * Date: 2017-04-06
 *
 * Version: V2.0.170412
 */
(function(g){var e={};g.fn.C4Design=e;e.Filed=function(s){var r={};r.value=function(t){if(t){return c(s,t)}else{return f(s)}};r.validation=function(t){return d(s,null,t)};r.empty=function(){return p(s)};r.type=function(){return o(s)};r.attributes=function(u,t){if(t!=undefined){g(a(s)).attr(u,t)}else{return g(a(s)).attr(u)}};r.addClass=function(t){if(t!=undefined&&t!=""){g(a(s)).addClass(t)}};r.inputRegular=function(t){if(t!=undefined&&t!=""){g(a(s)).attr("regular",t)}};r.invalidMessage=function(t){if(t!=undefined&&t!=""){g(a(s)).attr("invalid-msg",t)}};r.displayValueInTitle=function(){var t=f(s);if(t!=undefined&&t!=""){g("title").html(t+"_"+g("title").html())}};r.show=function(){g(k(s)).show()};r.hide=function(){g(k(s)).hide()};r.changeToShowHide=function(t,u){var v=[];if(u!=undefined){if(typeof(u)==="string"){v.push(q(t,u,""))}else{u.forEach(function(x,w){v.push(q(t,x,""))})}}n([{item:s,showSection:v}])};return r};e.Section=function(s){var r={};r.show=function(){g(k(s)).show()};r.hide=function(){g(k(s)).hide()};return r};e.Html=function(s){var r={};r.show=function(){g(k(s)).show()};r.hide=function(){g(k(s)).hide()};return r};e.Document=function(){var r={};r.status=j();r.setShowHideMultipl=function(s){n(s)};return r};e.User=function(r){GetUser(callBack())};function n(r){g(r).each(function(t,s){i(f(s.item),s.showSection,s.innerItem,false);if(PageMode!="preview"){a(s.item).change(function(){i(f(g(this).attr("name")),s.showSection,s.innerItem,true)})}if(s.hasOwnProperty("innerItem")){g(s.innerItem).each(function(v,u){if(u.hasOwnProperty("item")){n(u)}})}})}function q(r,u,t){var s={};s.ifValue=r;s.field=u;s.finder=t;return s}function l(t,r){if(typeof(r)==="string"){if(t==r||t.indexOf(r)>=0){return true}else{return false}}else{var s=false;r.forEach(function(v,u){if(t==v||t.indexOf(v)>=0){s=true}});return s}}function i(x,u,v,w){g(u).each(function(y,z){if(l(x,z.ifValue)){k(z.field,z.finder).show();d(z.field,z.finder)}else{k(z.field,z.finder).hide();p(z.field,z.finder);d(z.field,z.finder,false)}});if(v!=undefined){var t=v;var s=true;var r;while(t!=undefined){g(t).each(function(z,y){if(s){if(w){k(y.item,y.finder).hide();p(y.item,y.finder);d(y.item,y.finder,false)}r=f(y.item)}g(y.showSection).each(function(A,B){if(l(r,B.ifValue)){if(s){k(B.field,B.finder).show();d(B.field,B.finder)}}else{k(B.field,B.finder).hide();p(B.field,B.finder);d(B.field,B.finder,false)}});if(l(x,y.ifValue)){if(s){k(y.item,y.finder).show();d(y.item,y.finder)}}else{k(y.item,y.finder).hide();p(y.item,y.finder);d(y.item,y.finder,false)}r=f(y.item)});s=false;t=t[0].innerItem}}}function d(t,s,r){if(PageMode=="edit"||PageMode=="add"){if(r==undefined){g(k(t,s)).find("[req]:not([requirexd='required'])").attr("required","required").addClass("validatebox-invalid")}else{if(r){if(g(k(t,s)).find("[name][requirexd='required']").length<1){g(k(t,s)).find("[name]:not([requirexd='required'])").attr("required","required").addClass("validatebox-invalid")}}else{g(k(t,s)).find("[required]").removeAttr("required").removeClass("validatebox-invalid").attr("req","required")}}}else{return undefined}}function j(s){var r;if(s==undefined||s==""){r=f(s)}else{r=f("C4-WorkflowStateDisplayName")}if(PageMode=="add"&&(r==undefined||r=="")){return"new"}else{return r}}function p(s,r){if(PageMode=="edit"||PageMode=="add"){if(r==undefined||r==""){m(s)}else{g(k(s,r)).find("[name]").each(function(t,u){m(g(u).attr("name"))})}}else{return undefined}}function m(r){switch(o(r)){case"radio":case"checkbox":g(k(r)).find(":checked").removeAttr("checked");if(radiolist!=undefined&&radiolist.indexOf(r)<0){radiolist.push(r)}break;case"text":case"hidden":case"textarea":g(a(r)).val("");break;case"PeoplePicker":g(a(r)).parent().find("span").remove();g(a(r)).val("");g(a(r)).prev().val("");break;case"Richtext":CKEDITOR.instances["Metadata-"+r].setData("");break;case"MultiSelect":case"SingleSelect":g(a(r)).selectpicker("val",[]);if(radiolist!=undefined&&radiolist.indexOf(r)<0){radiolist.push(r)}break;default:return undefined}return true}function a(r){if(PageMode=="edit"||PageMode=="add"){return g("[name='"+r+"']")}else{return undefined}}function k(s,r){switch(r){case"parent":return g("[name='DIV_"+s+"']").parent().parent().parent().parent("panel");case"prev":if(g("[name='DIV_"+s+"']").prev().length<=0){return g("[name='DIV_"+s+"']").parent("form-group").prev()}else{return g("[name='DIV_"+s+"']").prev()}case"next":if(g("[name='DIV_"+s+"']").next().length<=0){return g("[name='DIV_"+s+"']").parent("form-group").next()}else{return g("[name='DIV_"+s+"']").next()}default:return g("[name='DIV_"+s+"']")}}function b(r){return JSON.parse(g("#Metadata-"+r+"_relationsvalue").attr("value"))}function o(t){if(t==undefined){return undefined}var v="";if(PageMode=="edit"||PageMode=="add"){var s;var u;if(typeof(t)==="string"){s=g("[name='"+t+"']");u=document.getElementsByName(t)[0]?document.getElementsByName(t)[0].tagName.toLowerCase():""
}else{s=g(t);u=s[0]?s[0].tagName.toLowerCase():""}switch(u){case"input":var r=g(s).attr("type");switch(r){case"radio":case"checkbox":case"text":v=r;break;case"hidden":if(g(s).parent(".x_dpBoxWrapper").length>0){v="PeoplePicker"}else{v=r}break;default:if(g(s).parent(".x_dpBoxWrapper").length>0){v="PeoplePicker"}else{v=r}break}break;case"textarea":if(g(s).next().find("iframe").length>0){v="Richtext"}else{v=u}break;case"select":if(g(s).attr("multiple")=="multiple"){v="MultiSelect"}else{v="SingleSelect"}break;case"div":v="div";break;default:return undefined}return v}else{return undefined}}function c(t,s){if(t==undefined){return""}switch(PageMode){case"preview":var r=g("[name='DIV_"+t+"'] div div");if(r.length==1){if(g(r).find("label").length>0){return g(r).find("label").eq(0).html(s)}else{return g(r).eq(0).html(s)}}else{return""}case"edit":case"add":m(t);switch(o(t)){case"radio":g(a(t)).find("[value='"+s+"']").attr("checked","checked");return;case"checkbox":if(typeof(s)=="string"){g(a(t)).find("[value='"+s+"']").attr("checked","checked")}else{if(typeof(s)=="object"){g(s).each(function(u,v){g(a(t)).find("[value='"+v+"']").attr("checked","checked")})}else{return undefined}}return;case"text":case"hidden":case"textarea":return g(a(t)).val(s);case"PeoplePicker":if(_xPeoplePickerArray){if(typeof(s)==="string"){_xPeoplePickerArray.forEach(function(u,v){if(u.key==t){u.item.setValue(s)}})}else{if(typeof(s)==="object"){_xPeoplePickerArray.forEach(function(u,v){if(u.key==t){s.forEach(function(x,w){u.item.setValue(x)})}})}else{return undefined}}}else{return undefined}return;case"Richtext":return CKEDITOR.instances["Metadata-"+t].setData(s);case"SingleSelect":case"MultiSelect":return g(a(t)).selectpicker("val",s);default:return undefined}default:return""}}function f(v){if(v==undefined){return""}switch(PageMode){case"preview":var r=g("[name='DIV_"+v+"'] div div");if(r.length==1){if(g(r).find("label").length>0){return g(r).find("label").eq(0).html().trim()}else{return g(r).eq(0).html().trim()}}else{return""}case"edit":case"add":switch(o(v)){case"radio":var w=g(k(v)).find(":checked").val();return w?w:"";case"checkbox":var t="";var s=g(k(v)).find(":checked");if(s.length>0){g(k(v)).find(":checked").each(function(x,y){if(x==0){t=g(y).val()}else{t=t+","+g(y).val()}})}else{t=""}return t;case"text":case"hidden":case"textarea":case"SingleSelect":case"PeoplePicker":return g(a(v)).val();case"Richtext":return CKEDITOR.instances["Metadata-"+v].getData();case"MultiSelect":var u=g(a(v)).val();if(u!=undefined&&u.length>0){return g(a(v)).val().join(",")}else{return""}default:if(g("[name='DIV_"+v+"']").length>0){return g("[name='DIV_"+v+"'] div").eq(1).html().trim()}else{return undefined}}default:return""}}function h(s,r){var s=Math.round(s*Math.pow(10,r))/Math.pow(10,r);return s}})(jQuery);var C4Design=$(this).C4Design;